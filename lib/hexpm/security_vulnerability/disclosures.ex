defmodule Hexpm.SecurityVulnerability.Disclosures do
  use Hexpm.Context

  alias Hexpm.SecurityVulnerability.Disclosure

  def all(package) do
    package
    |> Disclosure.all()
    |> Repo.all()
  end

  def upsert(attributes) do
    {_count, nil} =
      Repo.insert_all(Disclosure, attributes, on_conflict: :replace_all, conflict_target: [:id])

    :ok
  end
end
