defmodule HexpmWeb.API.VulnerabilityView do
  use HexpmWeb, :view

  def render("package." <> _, %{vulnerability: disclosure}) do
    render_one(disclosure, __MODULE__, "disclosure")
  end

  def render("disclosure", %{vulnerability: %{id: id, summary: summary, affected: affected}}) do
    %{
      id: id,
      summary: summary,
      affected: affected,
      api_url: "https://api.osv.dev/v1/vulns/#{URI.encode(id)}",
      html_url: "https://osv.dev/vulnerability/#{URI.encode(id)}"
    }
  end
end
